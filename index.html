<script type="module">
    // ... (Imports and Config same as above) ...
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";
    const db = getFirestore(app);

    document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        try {
            const userCredential = await signInWithEmailAndPassword(auth, email.value, password.value);
            const user = userCredential.user;

            // CHECK APPROVAL STATUS
            const userDoc = await getDoc(doc(db, "users", user.uid));
            
            if (userDoc.exists() && userDoc.data().isApproved === true) {
                window.location.href = "dashboard.html"; // Approved entry
            } else {
                await auth.signOut(); // Kick out if not approved
                alert("Account Pending Approval. Please contact the administrator.");
            }
        } catch (error) { alert("Login Failed: Check credentials."); }
    });
</script>
